Daniel Jones, Amanda Krysl, Braden Wicker

Databases Lab 7

To run the program, enter the following to set up the environment variables:

    export JDBC_URL=jdbc:mysql://db.labthreesixfive.com/your_username?autoReconnect=true\&useSSL=false
    export JDBC_USER=(your username)
    export JDBC_PW=(your password)

Then, enter the following on the command line:

    java InnReservations

Instructions:

    FR-1: Enter "Room" at the command prompt.

    FR-2: Enter "Book" at the command prompt.

    FR-3: Enter "Edit" at the command prompt.

    FR-4: Enter "Cancel" at the command prompt.

    FR-5: Enter "Details" at the command prompt.

    FR-6: Enter "Revenue" at the command prompt.


CAN YOU GUYS LOOK AT THIS PLEASE :)

WITH resTotals AS (
    SELECT room, checkin,
    (CASE
        WHEN MONTH(checkin) = MONTH(checkout)
            THEN (DATEDIFF(checkout,checkin))*rate
        WHEN MONTH(checkin) < MONTH(checkout)
            THEN (DATEDIFF(LAST_DAY(checkin),checkin)+1)*rate
        ELSE (DATEDIFF(checkout,
            (DATE_ADD(DATE_ADD(LAST_DAY(checkout),INTERVAL 1 DAY),
            INTERVAL - 1 MONTH))))*rate
    END) AS revenue
    FROM lab7_reservations
    WHERE YEAR(checkin) = 2019
), jan AS (
    SELECT room, SUM(revenue) AS revenue
    FROM resTotals
    WHERE MONTH(checkin) = 1
    GROUP BY room
), feb AS (
    SELECT room, SUM(revenue) AS revenue
    FROM resTotals
    WHERE MONTH(checkin) = 2
    GROUP BY room
), mar AS (
    SELECT room, SUM(revenue) AS revenue
    FROM resTotals
    WHERE MONTH(checkin) = 3
    GROUP BY room
), apr AS (
    SELECT room, SUM(revenue) AS revenue
    FROM resTotals
    WHERE MONTH(checkin) = 4
    GROUP BY room
), may AS (
    SELECT room, SUM(revenue) AS revenue
    FROM resTotals
    WHERE MONTH(checkin) = 5
    GROUP BY room
), jun AS (
    SELECT room, SUM(revenue) AS revenue
    FROM resTotals
    WHERE MONTH(checkin) = 6
    GROUP BY room
), jul AS (
    SELECT room, SUM(revenue) AS revenue
    FROM resTotals
    WHERE MONTH(checkin) = 7
    GROUP BY room
), aug AS (
    SELECT room, SUM(revenue) AS revenue
    FROM resTotals
    WHERE MONTH(checkin) = 8
    GROUP BY room
), sep AS (
    SELECT room, SUM(revenue) AS revenue
    FROM resTotals
    WHERE MONTH(checkin) = 9
    GROUP BY room
), oct AS (
    SELECT room, SUM(revenue) AS revenue
    FROM resTotals
    WHERE MONTH(checkin) = 10
    GROUP BY room
), nov AS (
    SELECT room, SUM(revenue) AS revenue
    FROM resTotals
    WHERE MONTH(checkin) = 11
    GROUP BY room
), decm AS (
    SELECT room, SUM(revenue) AS revenue
    FROM resTotals
    WHERE MONTH(checkin) = 12
    GROUP BY room
)

SELECT * from nov

SELECT jan.room, jan.revenue, feb.revenue, mar.revenue, apr.revenue,
    may.revenue, jun.revenue, jul.revenue, aug.revenue, sep.revenue,
    oct.revenue, nov.revenue, decm.revenue
FROM jan
    JOIN feb ON jan.room = feb.room
    JOIN mar ON jan.room = mar.room
    JOIN apr ON jan.room = apr.room
    JOIN may ON jan.room = may.room
    JOIN jun ON jan.room = jun.room
    JOIN jul ON jan.room = jul.room
    JOIN aug ON jan.room = aug.room
    JOIN sep ON jan.room = sep.room
    JOIN oct ON jan.room = oct.room
    JOIN nov ON jan.room = nov.room
    JOIN decm ON jan.room = decm.room;
